<!DOCTYPE html>
<html mxlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">

</head>

<body>
	<div th:fragment="bookManageFragment">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
			integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
			crossorigin="anonymous"></script>
		<link rel="stylesheet" href="/style/bookManage.css">
		<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
		<div class="book_manage_container">
			<div class="search_area">
				<form id="data_area">
					<input type="hidden" id="data_theme" name="booked_theme" th:value="${theme.id}">
					<input type="hidden" id="data_time" name="booked_time">
				</form>
				<h1 th:text="${theme.title}"></h1>
				<div id="datepicker"></div>


				<div id="result" class="result_area" style="padding: 15px;">

				</div>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.4.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script>
			$(function () {
				$("#datepicker").datepicker({
					dateFormat: 'yy/mm/dd',
					minDate: 0,
					showButtonPanel: false,
					changeMonth: false,
					changeYear: false,
					onSelect: function (dateText, inst) {
						var time=document.getElementById('data_time');
						var sector=document.getElementById('result');
						time.value=dateText;
						sector.innerHTML = "";
						var formdata=new FormData(document.getElementById('data_area'))
						axios.post('/admin/bookList',formdata)
						.then(function(response){
							const data=response.data;
							data.forEach(book=>{
								const topul =document.createElement('ul');
								topul.innerHTML=`예약일자 : ${book.booked_date}`
								const username=document.createElement('li');
								username.innerHTML=`예약자 : ${book.booked_name}`;
								topul.appendChild(username);
								const bookedTime=document.createElement('li');
								bookedTime.innerHTML=`예약시간 : ${book.booked_time}`;
								topul.appendChild(bookedTime);
								const peoples =document.createElement('li');
								peoples.innerHTML=`인원수 : ${book.people_count}`;
								topul.appendChild(peoples);
								const phone = document.createElement('li');
								phone.innerHTML=`전화번호 : ${book.phone}`;
								topul.appendChild(phone);
								sector.appendChild(topul);
							})
						})
					}
				});
				$("#datepicker").show();
			});
		</script>
	</div>
</body>

</html>